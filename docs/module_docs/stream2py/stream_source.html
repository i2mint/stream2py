<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>stream2py.stream_source &mdash; stream2py 1.0.42 documentation</title><link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/toggleprompt.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="stream2py.tests.test_buffer_reader" href="tests/test_buffer_reader.html" />
    <link rel="prev" title="stream2py.stream_buffer" href="stream_buffer.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            stream2py
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../stream2py.html">stream2py</a></li>
<li class="toctree-l1"><a class="reference internal" href="buffer_reader.html">stream2py.buffer_reader</a></li>
<li class="toctree-l1"><a class="reference internal" href="protocols.html">stream2py.protocols</a></li>
<li class="toctree-l1"><a class="reference internal" href="simply.html">stream2py.simply</a></li>
<li class="toctree-l1"><a class="reference internal" href="source_reader.html">stream2py.source_reader</a></li>
<li class="toctree-l1"><a class="reference internal" href="sources.html">stream2py.sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="sources/http.html">HTTP Response streaming reader with no external dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="stream_buffer.html">stream2py.stream_buffer</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">stream2py.stream_source</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/test_buffer_reader.html">stream2py.tests.test_buffer_reader</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/test_lock_sorted_deque.html">stream2py.tests.test_lock_sorted_deque</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/test_source_reader.html">stream2py.tests.test_source_reader</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/test_stream_buffer.html">stream2py.tests.test_stream_buffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/test_stream_source.html">stream2py.tests.test_stream_source</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/test_util.html">stream2py.tests.test_util</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests/utils_for_testing.html">stream2py.tests.utils_for_testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="util.html">stream2py.util</a></li>
<li class="toctree-l1"><a class="reference internal" href="utility/locked_sorted_deque.html">stream2py.utility.locked_sorted_deque</a></li>
<li class="toctree-l1"><a class="reference internal" href="utility/reader_writer_lock.html">stream2py.utility.reader_writer_lock</a></li>
<li class="toctree-l1"><a class="reference internal" href="utility/sorted_collection.html">stream2py.utility.sorted_collection</a></li>
<li class="toctree-l1"><a class="reference internal" href="utility/sorted_deque.html">stream2py.utility.sorted_deque</a></li>
<li class="toctree-l1"><a class="reference internal" href="utility/typing_hints.html">stream2py.utility.typing_hints</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">stream2py</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">stream2py.stream_source</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/module_docs/stream2py/stream_source.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-stream2py.stream_source">
<span id="stream2py-stream-source"></span><h1>stream2py.stream_source<a class="headerlink" href="#module-stream2py.stream_source" title="Permalink to this headline">¶</a></h1>
<p>A BufferReader gives data access to any number of consumers and provides methods to seek data such
as next(), range(), head(), tail().  Each BufferReader instance has it’s own cursor keeping track of
what data was last seen.</p>
<dl class="py class">
<dt id="stream2py.stream_source.StreamSource">
<em class="property">class </em><code class="sig-prename descclassname">stream2py.stream_source.</code><code class="sig-name descname">StreamSource</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">reader_cls=&lt;class 'stream2py.buffer_reader.BufferReader'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/stream2py/stream_source.html#StreamSource"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#stream2py.stream_source.StreamSource" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract parent class for reading from a source into a StreamBuffer.</p>
<p>Provides interfaces for configuring the StreamBuffer and instantiating BufferReaders.</p>
<p>The open method will be called when creating a reader with open_reader().
The close method will be called when all open readers have been closed().
This will also stop the StreamBuffer. A closed source can be reopened by opening another reader.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stream2py.examples.stream_source</span> <span class="kn">import</span> <span class="n">SimpleCounterString</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source</span> <span class="o">=</span> <span class="n">SimpleCounterString</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">source</span><span class="o">.</span><span class="n">open_reader</span><span class="p">()</span> <span class="k">as</span> <span class="n">reader</span><span class="p">:</span>
<span class="gp">... </span>    <span class="c1"># the source will close when exiting the context</span>
<span class="gp">... </span>    <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="go">&#39;s0&#39;</span>
<span class="go">&#39;s1&#39;</span>
<span class="go">&#39;s2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reader2</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">open_reader</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reader2</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="go">&#39;s0&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reader2</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># closing the reader manually</span>
</pre></div>
</div>
<dl class="py method">
<dt id="stream2py.stream_source.StreamSource.configure_buffer">
<code class="sig-name descname">configure_buffer</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">maxlen</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sleep_time_on_read_none_s</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Union<span class="p">[</span>int<span class="p">, </span>float<span class="p">]</span><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">auto_drop</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/stream2py/stream_source.html#StreamSource.configure_buffer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#stream2py.stream_source.StreamSource.configure_buffer" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets custom buffer parameters.</p>
</dd></dl>

<dl class="py method">
<dt id="stream2py.stream_source.StreamSource.get_timestamp">
<em class="property">classmethod </em><code class="sig-name descname">get_timestamp</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="../../_modules/stream2py/stream_source.html#StreamSource.get_timestamp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#stream2py.stream_source.StreamSource.get_timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Get timestamp of now as int microseconds</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>timestamp in UTC microseconds</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="stream2py.stream_source.StreamSource.open_reader">
<code class="sig-name descname">open_reader</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">read_size</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">strict_n</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">ignore_no_item_found</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/stream2py/stream_source.html#StreamSource.open_reader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#stream2py.stream_source.StreamSource.open_reader" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiates a reader.
:param read_size: number of items to return by default when reading.</p>
<blockquote>
<div><p>Is also used as the “chunk size” when iterating.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>strict_n</strong> – if True, by default a ValueError witll be raised if the
exact number of requested items are not available when reading.</p></li>
<li><p><strong>ignore_no_item_found</strong> – if True, by default return None when no next item
instead of raising exception during a read</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="stream2py.stream_source.StreamSource.set_sleep_time_on_iter_none">
<code class="sig-name descname">set_sleep_time_on_iter_none</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sleep_time_s</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">0.1</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/stream2py/stream_source.html#StreamSource.set_sleep_time_on_iter_none"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#stream2py.stream_source.StreamSource.set_sleep_time_on_iter_none" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the sleep time of the iter yield loop when next data item is not yet available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sleep_time_s</strong> – seconds to sleep</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="stream2py.stream_source.StreamSource.sleep_time_on_read_none_s">
<em class="property">property </em><code class="sig-name descname">sleep_time_on_read_none_s</code><a class="headerlink" href="#stream2py.stream_source.StreamSource.sleep_time_on_read_none_s" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets default sleep time for StreamBuffer when it reads None from SourceReader.
Useful when you know the period between data points.</p>
<p>For example if data only comes once every 10 seconds,
it would be inefficient to try and read again every 0.1 seconds and get None up to 100 times
but every 10 seconds or even 1 second would be much more reasonable depending on the use
case. Not necessary if read is a blocking function that always returns a data point.</p>
<p>Default is None which delegates the sleep time to StreamBuffer’s default.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Optional[Union[int, float]] number of seconds to sleep</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="stream2py.stream_source.defaulted_values">
<code class="sig-prename descclassname">stream2py.stream_source.</code><code class="sig-name descname">defaulted_values</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">source_dict</span></em>, <em class="sig-param"><span class="n">defaults</span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/stream2py/stream_source.html#defaulted_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#stream2py.stream_source.defaulted_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a the values of source_dict where None values are replaced with the
corresponding <cite>default_dict</cite> values.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">defaults</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">tuple</span><span class="p">(</span><span class="n">defaulted_values</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span> <span class="n">defaults</span><span class="p">))</span>
<span class="go">(1, 22, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">tuple</span><span class="p">(</span><span class="n">defaulted_values</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">},</span> <span class="n">defaults</span><span class="p">))</span>
<span class="go">(False, True, 3)</span>
</pre></div>
</div>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="stream_buffer.html" class="btn btn-neutral float-left" title="stream2py.stream_buffer" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tests/test_buffer_reader.html" class="btn btn-neutral float-right" title="stream2py.tests.test_buffer_reader" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 
2021
Otosense.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>